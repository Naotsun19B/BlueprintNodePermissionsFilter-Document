![UE Version](https://img.shields.io/badge/Unreal%20Engine-5.4--5.7-0e1128?logo=unrealengine&logoColor=white)
[![License: Fab Standard License (Fab EULA)](https://img.shields.io/badge/License-Fab%20Standard%20License%20%28Fab%20EULA%29-blue)](https://www.fab.com/eula)
[![X (formerly Twitter) Follow](https://img.shields.io/twitter/follow/Naotsun_UE?style=social)](https://twitter.com/Naotsun_UE)

# BlueprintNodePermissionsFilter

<img width="1873" height="101" alt="Image" src="https://github.com/user-attachments/assets/adca207b-eed4-4c33-b7a1-f1a3f5c314f7" />

<!--ts-->
* [概要](#概要)
* [動作環境](#動作環境)
* [インストール](#インストール)
* [機能と使い方](#機能と使い方)
  * [グループシステム](#グループシステム)
    * [管理者グループ](#管理者グループ)
    * [不明グループ](#不明グループ)
    * [カスタムグループ](#カスタムグループ)
    * [グループの階層構造](#グループの階層構造)
    * [編集スコープ](#編集スコープ)
  * [フィルタシステム](#フィルタシステム)
    * [フィルタ状態](#フィルタ状態)
    * [対応するノードの種類](#対応するノードの種類)
  * [UIの使い方](#uiの使い方)
    * [グループツリービュー](#グループツリービュー)
    * [フィルタツリービュー](#フィルタツリービュー)
    * [グループセレクタダイアログ](#グループセレクタダイアログ)
  * [ショートカットキー](#ショートカットキー)
* [オプション](#オプション)
  * [グループ設定](#グループ設定)
  * [各グループの設定](#各グループの設定)
  * [フィルタ設定](#フィルタ設定)
  * [フレーム分散タスクマネージャー設定](#フレーム分散タスクマネージャー設定)
  * [個人設定](#個人設定)
* [ライセンス](#ライセンス)
* [作者](#作者)
* [履歴](#履歴)
<!--te-->

## 概要

このプラグインはブループリントエディタのアクションメニュー（右クリックコンテキストメニュー）に表示されるノードを、職種などのグループごとに管理できる機能を追加します。  
例えば、処理負荷の高いエンジン標準ノードをチームメンバーから非表示にし、自作した処理負荷の軽いノードの使用を強制するといった運用が可能です。  

<img width="2542" height="971" alt="Image" src="https://github.com/user-attachments/assets/8161d2b3-5d51-4f3b-99b6-192b8d7ba45b" />
<img width="1211" height="523" alt="Image" src="https://github.com/user-attachments/assets/fb11e2b7-6f29-480d-af0b-d7cb754374bb" />
<img width="2540" height="1042" alt="Image" src="https://github.com/user-attachments/assets/cf81f67c-ec24-42a5-8689-9a81981436b0" />

## 動作環境

対象バージョン : UE5.4 ～ 5.7  
対象プラットフォーム : Windows, Mac, Linux  

## インストール

準備中  

## 機能と使い方

### グループシステム

このプラグインではブループリントノードの表示権限をグループ単位で管理します。  
グループは階層構造を持ち、チームの役割（プログラマー、デザイナーなど）に応じて異なるノードセットを提供できます。  

#### 管理者グループ

管理者グループはプラグインに組み込まれたルートグループです。  
以下の特徴があります。  

- グループ階層の最上位に位置し、親グループを持ちません  
- すべてのノードが表示され、フィルタリングは適用されません  
- すべてのグループの編集権限（`AllGroups`）を持ちます  

#### 不明グループ

不明グループは初回起動時やユーザーが選択していたグループが削除された場合などに一時的に割り当てられるプレースホルダーグループです。  
以下の特徴があります。  

- すべてのノードがフィルタリングされ、ブループリントエディタのアクションメニューにノードが表示されません  
- 編集権限は`ReadOnly`であり、フィルタ設定やグループ構造の変更はできません  
- 子グループを持つことはできません  

不明グループが選択されている間はグループセレクタダイアログが表示され、有効なグループを再選択するよう促されます。

#### カスタムグループ

ユーザーが作成するグループです。
各カスタムグループは以下の情報を持ちます。

| **プロパティ**        | **説明**                           |
|-------------------|----------------------------------|
| Group Name        | グループの一意な識別名                      |
| Group Display Name | UIに表示されるグループの表示名                 |
| Group Description | グループの説明文                         |
| Edit Scope        | このグループの編集権限レベル                   |
| Is Filtered Per Filter | 各フィルタのGUIDに対する許可/拒否の設定マップ        |

カスタムグループの設定は `[Project]/Config/BlueprintNodePermissionsFilter/` ディレクトリにINIファイルとして保存されます。  
子グループはサブディレクトリに格納されます。  

#### グループの階層構造

グループは親子関係を持つ木構造で管理されます。  
管理者グループをルートとして、その下にカスタムグループを自由に配置できます。  
子グループは親グループのフィルタ設定を継承し、フィルタ状態を`Inherit`（継承）に設定することで親の設定をそのまま引き継ぐことができます。  

#### 編集スコープ

各グループにはフィルタ設定の編集権限を制御する編集スコープが設定されます。  

| **編集スコープ**           | **説明**                     |
|----------------------|----------------------------|
| ReadOnly             | フィルタ設定の編集は不可               |
| SelectedGroupOnly    | 自身のグループのフィルタ設定のみ編集可能       |
| ChildGroupsOnly      | 自身のグループと子グループのフィルタ設定を編集可能  |
| AllGroups            | すべてのグループのフィルタ設定と階層構造を編集可能  |

### フィルタシステム

フィルタシステムはブループリントエディタのアクションメニューに表示されるノードの表示/非表示を制御します。  

#### フィルタ状態

各フィルタには以下の3つの状態を設定できます。  

| **フィルタ状態** | **説明**                         |
|-----------|--------------------------------|
| Allow     | ノードを表示します（許可）                  |
| Deny      | ノードを非表示にします（拒否）                |
| Inherit   | 親グループのフィルタ設定を継承します             |

#### 対応するノードの種類

このプラグインは以下の種類のブループリントノードに対応したフィルタを提供します。  

| **フィルタ名**                     | **対象ノード**          |
|-------------------------------|---------------------|
| Function                      | 関数呼び出しノード           |
| Event                         | イベント・イベントディスパッチャーノード |
| Bound Event                   | バインドイベントノード         |
| Delegate                      | デリゲートノード            |
| Variable                      | 変数Get/Setノード        |
| Struct                        | 構造体ノード              |
| Instanced Struct              | インスタンス化構造体ノード       |
| Enum                          | 列挙体ノード              |
| Dynamic Cast                  | 型キャストノード            |
| Input Event                   | 入力イベントノード           |
| Input Key                     | 入力キーノード             |
| Input Axis Key                | 入力軸キーノード            |
| Input Debug Key               | デバッグ入力ノード           |
| Get Input Axis Key Value      | 入力軸キー値取得ノード         |
| Get Subsystem                 | サブシステムアクセスノード       |

上記に該当しないノードについてはデフォルトのフォールバックフィルタが適用されます。    
フォールバックフィルタでは関数名でノードの一意性を判断するため、自作ノードなどで上記に該当しない場合は追加でフィルタを実装することを推奨します。  

### UIの使い方

#### グループツリービュー

<img width="2542" height="971" alt="Image" src="https://github.com/user-attachments/assets/8161d2b3-5d51-4f3b-99b6-192b8d7ba45b" />

グループツリービューはグループの階層構造を表示・操作するためのUIです。  
以下のカラムで構成されます。  

| **カラム**            | **説明**                    |
|--------------------|---------------------------|
| Group Name         | グループ名（編集可能）               |
| Edit Scope         | グループの編集権限レベル              |
| Allowed Filters    | そのグループで表示が許可されているノードの数    |

コンテキストメニューから以下の操作が可能です。

- 新しいサブグループの追加
- グループのコピー・移動
- グループの削除
- グループ設定の編集（エディタ環境設定を開く）

また、ドラッグアンドドロップでグループ階層の並び替えができます。

#### フィルタツリービュー

<img width="2540" height="1042" alt="Image" src="https://github.com/user-attachments/assets/cf81f67c-ec24-42a5-8689-9a81981436b0" />

フィルタツリービューは選択中のグループに対するフィルタの一覧を表示・操作するためのUIです。  
以下のカラムで構成されます。  

| **カラム**            | **説明**                             |
|--------------------|------------------------------------|
| Display Name       | フィルタ名（ノード名）                        |
| Filter State       | フィルタの状態（Allow / Deny / Inherit ボタン） |

フィルタの表示形式は以下の2種類から選択できます。

| **グルーピング方式**          | **説明**                      |
|-----------------------|-----------------------------|
| By Category           | カテゴリパスで階層的にグルーピング           |
| By Action Owner       | アクションのオーナー（アセットやクラス）でグルーピング |

コンテキストメニューからグルーピング方式の変更や、選択中のフィルタの一括状態変更が可能です。

#### グループセレクタダイアログ

<img width="934" height="270" alt="Image" src="https://github.com/user-attachments/assets/f4c7446e-a17c-4b72-8397-8a6a483e0c07" />

エディタ起動時にユーザーが所属するグループが不明な場合、グループセレクタダイアログが表示されます。  
ここでユーザーは自分が所属するグループを選択します。  
この選択はユーザーごとの個人設定として保存されます。  
エディタ環境設定から起動時のダイアログ表示を無効にすることもできます。  
グループセレクタダイアログで起動時に再選択を促さないようにもできますが、その場合は後からグループ設定の`Affiliated Group`から選択できます。  

### ショートカットキー

<img width="1300" height="357" alt="Image" src="https://github.com/user-attachments/assets/a96dccc6-0334-4db5-8048-0b705980f7be" />

プラグインは以下のショートカットキーを提供します。
これらはコンテキストメニューやキーボードショートカットから実行可能です。

| **コマンド**                               | **説明**                      |
|----------------------------------------|-----------------------------|
| Add New Group                          | 新しいサブグループを作成                |
| Open Group Settings                    | グループ設定をエディタ環境設定で開く          |
| Change To Grouping By Category         | フィルタリストをカテゴリでグルーピング         |
| Change To Grouping By Action Owner     | フィルタリストをアクションオーナーでグルーピング    |
| Change Filter State To Allow           | 選択中のフィルタを許可状態に変更            |
| Change Filter State To Deny            | 選択中のフィルタを拒否状態に変更            |
| Change Filter State To Inherit         | 選択中のフィルタを継承状態に変更            |

## オプション

エディタ環境設定から設定できる項目は以下の通りです。

#### グループ設定

<img width="2542" height="971" alt="Image" src="https://github.com/user-attachments/assets/8161d2b3-5d51-4f3b-99b6-192b8d7ba45b" />

プロジェクト全体のグループ管理に関する設定です。

| **カテゴリ** | **項目**           | **説明**                                                                                                   |
|----------|------------------|----------------------------------------------------------------------------------------------------------|
| Shared   | Groups           | このプロジェクトで選択可能なグループの一覧をツリービューで表示します。所属グループの編集スコープに含まれるグループのみ編集できます。 |
| Personal | Affiliated Group | 現在所属しているグループを選択します。                                                                                      |

作成したグループの設定はエディタ環境設定の`Blueprint Node Permissions Filter`セクションに追加されます。

#### 各グループの設定

<img width="2540" height="1042" alt="Image" src="https://github.com/user-attachments/assets/cf81f67c-ec24-42a5-8689-9a81981436b0" />

各カスタムグループのコンテキストメニューの`Open Group Settings`から、そのグループの設定をエディタ環境設定で開くことができます。

| **カテゴリ**     | **項目**               | **説明**                                                             |
|--------------|----------------------|--------------------------------------------------------------------|
| Profile      | Group Name           | グループの一意な識別名。INIファイル名やディレクトリ名にも使用されます。                              |
|              | Group Display Name   | ツリービューに表示されるグループの表示名。未設定の場合はGroup Nameが使用されます。                     |
|              | Group Description    | グループの説明文。                                                          |
|              | Edit Scope           | このグループの編集権限レベル。                                                    |
| Permissions  | Is Filtered Per Filter | フィルタツリービューで各ノードの表示/非表示/継承の状態を設定します。                                |

### フィルタ設定

<img width="1311" height="355" alt="Image" src="https://github.com/user-attachments/assets/433ec331-a115-438d-a02a-3dde966fc19e" />

フィルタシステム全体に適用されるデフォルト設定です。

| **項目**                              | **説明**                                        |
|-------------------------------------|-----------------------------------------------|
| Node Spawner Classes To Exclude     | フィルタシステムから除外するノードスポナークラスの一覧。指定したクラスのノードはフィルタリングの対象外となります。 |
| Node Classes To Exclude             | フィルタシステムから除外するノードクラスの一覧。指定したクラスのノードはフィルタリングの対象外となります。   |
| Action Owner Classes To Exclude     | フィルタシステムから除外するアクションオーナークラスの一覧。指定したアセットタイプに属するノードはフィルタリングの対象外となります。 |

### フレーム分散タスクマネージャー設定

<img width="1116" height="461" alt="Image" src="https://github.com/user-attachments/assets/a022a612-6229-46cc-93e7-18def0b40ada" />

フレーム分散タスクスケジューラのチューニング設定です。
フレーム分散タスクマネージャーは1フレームあたりの合計処理時間（グローバルバジェット）を管理し、登録されたタスクに優先度（ウェイト）に基づいて時間を割り当てます。
この設定はすべてのプロジェクトで共有されます。

プラグイン内では以下の処理がフレーム分散タスクとして実行されます。

| **タスク**                                    | **説明**                                                                           |
|----------------------------------------------|----------------------------------------------------------------------------------|
| Apply Selected Group Filter States           | 所属グループ変更時に、選択されたグループのフィルタ状態を全ノードに適用します。進行状況はエディタの通知に表示されます。 |
| Count Num Of Allowed Filters                 | グループで許可されているノード数をカウントし、グループツリービューの`Allowed Filters`カラムに反映します。            |
| Construct Filter Tree View Nodes             | フィルタツリービューのツリーノードを構築します。カテゴリやアクションオーナーによるグルーピング形式に応じたツリーを生成します。 |

| **カテゴリ**              | **項目**                              | **説明**                                                                       |
|-----------------------|-------------------------------------|------------------------------------------------------------------------------|
| Global Budget Per Frame | Should Be Adjusted Automatically  | エディタの負荷状況に応じて1フレームあたりの合計処理時間バジェット（秒）を自動調整するかどうか。                             |
|                       | Manual Value                        | 1フレームあたりの合計処理時間バジェット（秒）の手動設定値。自動調整が無効の場合に使用されます。                             |
|                       | Minimum Limit                       | 自動調整時の1フレームあたりの合計処理時間バジェット（秒）の下限値。                                           |
|                       | Maximum Limit                       | 自動調整時の1フレームあたりの合計処理時間バジェット（秒）の上限値。                                           |
| Limitation            | Max Rounds Per Frame                | 1フレームで実行する最大ラウンド数。各ラウンドで残りバジェットが優先度とエイジング補正に基づいて再分配されます。                    |
| Aging                 | Weight Factor                       | 低優先度タスクの救済度合い。値が大きいほど、処理待ちのタスクにより多くのフレームバジェットが割り当てられます。                      |
|                       | Max Boost                           | エイジングによる優先度補正倍率の上限。                                                          |
| Automatic Adjustment  | Task Budget Ratio                   | エディタのフレーム時間に対するタスクバジェットの割合（例: 0.03 = 3%）。自動調整が有効の場合に使用されます。                |
| Other                 | Frame Follow Alpha                  | フレーム追跡用の指数移動平均の係数。                                                           |

### 個人設定

ユーザーごとに保存される個人設定です。
この設定はエディタ環境設定パネルには表示されず、プラグインの内部処理によって自動的に管理されます。  
設定値は `Saved/Config/` ディレクトリ以下の `Editor.ini` に保存されます。

| **項目**                                           | **説明**                                  |
|--------------------------------------------------|------------------------------------------|
| Selected Group Guid                              | 現在選択されているグループのGUID                      |
| Disable Group Selector Dialog When Startup       | エディタ起動時のグループセレクタダイアログを無効にするかどうか          |

## ライセンス

本リポジトリはドキュメントのみを含みます。プラグイン本体のソースコード／バイナリは含みません。  
プラグイン本体は Fab 上で配布され、利用者には [Fab Standard License (Fab EULA)](https://www.fab.com/ja/eula) に基づいて提供されます。  
特に明記がない限り、本リポジトリ内のドキュメントの著作権は © 2025-2026 Naotsun に帰属し、無断転載は禁止です。

## 作者

[Naotsun](https://twitter.com/Naotsun_UE)

## 履歴

準備中
